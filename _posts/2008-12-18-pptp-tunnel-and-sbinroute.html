---
layout: post
title: PPTP Tunnel and /sbin/route
date: '2008-12-18T14:17:00.004-05:00'
author: rammic
tags:
- damntheman
- hacking
modified_time: '2008-12-18T14:28:58.905-05:00'
blogger_id: tag:blogger.com,1999:blog-6180833599810788176.post-4225160762277935603
blogger_orig_url: http://blog.rammic.com/2008/12/pptp-tunnel-and-sbinroute.html
---

My SSH tunnel was acting flaky, so I decided to use the PPTP server feature on my DD-WRT router. It was extremely straightforward, though sending all traffic through the tunnel was a non-starter. To fix it, I had to route my "naughty" sites through the VPN and around the corporate network. My router at home is configured to use <span class="Apple-style-span"  style="font-family:arial;">192.168.1.0/24</span>. <div><br /></div><div><div><span class="Apple-style-span"  style="font-family:arial;">#!/bin/sh</span></div><div><span class="Apple-style-span"  style="font-family:arial;">/sbin/route -n add -net login.oscar.aol.com $IPREMOTE >> /tmp/ppp.log 2>&amp;1</span></div><div><span class="Apple-style-span"  style="font-family:arial;">/sbin/route -n add -net talk.google.com $IPREMOTE >> /tmp/ppp.log 2>&amp;1</span></div><div><span class="Apple-style-span"  style="font-family:arial;">/sbin/route -n add -net imap.gmail.com $IPREMOTE >> /tmp/ppp.log 2>&amp;1</span></div><div><span class="Apple-style-span"  style="font-family:arial;">/sbin/route -n add -net smtp.gmail.com $IPREMOTE >> /tmp/ppp.log 2>&amp;1</span></div><div><span class="Apple-style-span"  style="font-family:arial;">/sbin/route -n add -net facebook.com $IPREMOTE >> /tmp/ppp.log 2>&amp;1</span></div><div><span class="Apple-style-span"  style="font-family:arial;">/sbin/route -n add -net ebay.com $IPREMOTE >> /tmp/ppp.log 2>&amp;1<br /></span></div><div><span class="Apple-style-span"  style="font-family:arial;">/sbin/route -n add -net me.com $IPREMOTE >> /tmp/ppp.log 2>&amp;1</span></div><div><span class="Apple-style-span"  style="font-family:arial;">/sbin/route -n add -net mail.mac.com $IPREMOTE >> /tmp/ppp.log 2>&amp;1</span></div><div><span class="Apple-style-span"  style="font-family:arial;">/sbin/route -n add -net gmail-imap.l.google.com $IPREMOTE >> /tmp/ppp.log 2>&amp;1</span></div><div><span class="Apple-style-span"  style="font-family:arial;">/sbin/route -n add -net gmail-smtp.l.google.com $IPREMOTE >> /tmp/ppp.log 2>&amp;1</span></div><div><span class="Apple-style-span"  style="font-family:arial;">/sbin/route -n add -net 205.188.0.0/16 $IPREMOTE >> /tmp/ppp.log 2>&amp;1</span></div><div><span class="Apple-style-span"  style="font-family:arial;">/sbin/route -n add -net 64.12.0.0/16 $IPREMOTE >> /tmp/ppp.log 2>&amp;1</span></div><div><br /></div><div>This belongs in the <span class="Apple-style-span"  style="font-family:arial;">/etc/ppp/ip-up</span> config file which should be set as executable. The script is run upon successful connection to the VPN. The last two entries are required to route AIM traffic through the tunnel. The background of this config can be found here: <a href="http://www.easyzonecorp.net/network/view.php?ID=572">http://www.easyzonecorp.net/network/view.php?ID=572</a></div></div>