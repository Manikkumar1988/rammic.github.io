---
layout: post
title: myFail Web Site
date: '2009-11-09T23:56:00.013-05:00'
author: rammic
tags:
- security
- stupidity
modified_time: '2009-11-10T01:50:19.536-05:00'
thumbnail: http://2.bp.blogspot.com/_wC5IWJgdgwA/SvjzN3KQHVI/AAAAAAAAC9M/u5ZnxpfAGEY/s72-c/myFail.jpg
blogger_id: tag:blogger.com,1999:blog-6180833599810788176.post-2661075768538347212
blogger_orig_url: http://blog.rammic.com/2009/11/myfail-web-site.html
---

<div>Logging into the DFAS myPay site is frustrating. This is the gateway where DoD employees can view and change their financial data and records.</div><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://2.bp.blogspot.com/_wC5IWJgdgwA/SvjzN3KQHVI/AAAAAAAAC9M/u5ZnxpfAGEY/s1600-h/myFail.jpg"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 211px; height: 400px;" src="http://2.bp.blogspot.com/_wC5IWJgdgwA/SvjzN3KQHVI/AAAAAAAAC9M/u5ZnxpfAGEY/s400/myFail.jpg" border="0" alt="" id="BLOGGER_PHOTO_ID_5402335172501708114" /></a><br /><div>In an attempt secure the interface (namely to prevent key loggers), they have implemented a javascript-based keyboard where the user must enter their PIN using their mouse (or using the keyboard pressing tab LOTS of times). A randomization function is used to change the position of the buttons, presumably to prevent a simple click-tracking virus from simply replaying the click sequence. Numbers always appear on the upper row and the letters will appear in a random position on the same row where they exist on the keyboard (e.g. QWERTY letters will always appear on the top row, just in a random order).</div><div>At first glance, I assumed that there would be some server-side state that identified the position of the buttons (as to not allow the user's browser to arbitrarily choose the positions). Looking at how the button layout is generated, however, makes it clear that the position is indeed generated by the client-side alone. Javascript functions are called to randomize the locations, and the locations of these buttons are included as part of the POST parameters upon authentication. A <span class="Apple-style-span"  style="font-family:'courier new';">visOrder</span> variable is included with a simple substitution cipher to identify button locations: 0 is represented by position 0, 1 by position 1, etc. Thus:</div><div><span class="Apple-style-span"  style="font-family:'courier new';">VisOrder     =3601827594</span></div><div><span class="Apple-style-span"  style="font-family:'courier new';">Substitution =0123456789</span></div><div><span class="Apple-style-span"  style="font-family:'courier new';">Example PIN  =325476</span></div><div><span class="Apple-style-span"  style="font-family:'courier new';">Encoded      =102867</span></div><div>Thus any virus/program can easily mount an online guessing attack (since it defines the substitution pattern), and can quickly decipher the PIN if it has access to the POST parameters. </div><div>The web site's security implementation is painfully trivial, so we can conclude that the Javascript keyboard is only to prevent keyloggers. But it has a number of side effects, especially with respect to the security of the password. Given the tedious nature of PIN entry, users choose extremely simplistic passwords. MyPay actually encourages this as it does not enforce complexity requirements and limits the length of the password between 4 and 8 characters. There is no support for upper/lower case or special characters. 36 possible values over an 4-character search space is not terribly secure.</div><div>I think that myPay has allowed their paranoia about keyloggers to overtake reasonable design and security decisions about the rest of their system. A system infected with such a device or software has been critically compromised anyway, and will have access to at least system-level passwords and the SSN of the user logging into myPay (the SSN/LoginID field is not protected by the virtual keyboard function). It is an insight to the simplistic view of security that too many hold, and also has the unfortunate manifestation in a terribly unusable user interface.</div>